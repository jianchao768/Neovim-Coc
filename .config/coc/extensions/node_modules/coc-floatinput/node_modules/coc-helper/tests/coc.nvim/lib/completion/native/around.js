'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
exports.register = exports.Around = void 0;
const tslib_1 = require("tslib");
const util_1 = require("../../util");
const source_1 = tslib_1.__importDefault(require("../source"));
class Around extends source_1.default {
    constructor(keywords) {
        super({ name: 'around', filepath: __filename });
        this.keywords = keywords;
    }
    async doComplete(opt, token) {
        let { bufnr, input, word, linenr, triggerForInComplete } = opt;
        let buf = this.keywords.getItem(bufnr);
        await (0, util_1.waitImmediate)();
        if (!triggerForInComplete)
            this.noMatchWords = new Set();
        if (input.length === 0 || !buf || token.isCancellationRequested)
            return null;
        let iterable = buf.matchWords(linenr - 1);
        let items = new Set();
        let isIncomplete = await this.getResults([iterable], input, word, items, token);
        return {
            isIncomplete, items: Array.from(items).map(s => {
                return { word: s };
            })
        };
    }
}
exports.Around = Around;
function register(sourceMap, keywords) {
    let source = new Around(keywords);
    sourceMap.set('around', source);
}
exports.register = register;
//# sourceMappingURL=around.js.map